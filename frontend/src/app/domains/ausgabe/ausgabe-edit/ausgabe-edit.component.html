<form class="ausgabe-form" [formGroup]="form" (ngSubmit)="save()">
  <mat-card>

    <mat-card-title>Ausgabe erfassen/mutieren</mat-card-title>
    <mat-card-content>

      <!-- Datum -->
      <mat-form-field class="full-width">
        <mat-label>Datum</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="datum"
          placeholder="Buchungsdatum"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>

        @if (form.get('datum')?.hasError('required') && form.get('datum')?.touched) {
          <mat-error>Datum ist erforderlich</mat-error>
        }
      </mat-form-field>

      <!-- Empfänger -->
      <mat-form-field class="full-width">
        <mat-label>Empfänger</mat-label>
        <input
          matInput
          formControlName="empfaenger"
          placeholder="Empfänger"
        />

        @if (form.get('empfaenger')?.hasError('required') && form.get('empfaenger')?.touched) {
          <mat-error>Empfänger ist erforderlich</mat-error>
        }
      </mat-form-field>

      <!-- Kategorie -->
      <mat-form-field class="full-width">
        <mat-label>Kategorie</mat-label>
        <mat-select formControlName="kategorie">
          @for (k of kategorien; track k) {
            <mat-option [value]="k">
              {{ k }}
            </mat-option>
          }
        </mat-select>

        @if (form.get('kategorie')?.hasError('required') && form.get('kategorie')?.touched) {
          <mat-error>Kategorie ist erforderlich</mat-error>
        }
      </mat-form-field>

      <!-- Beschreibung / Notiz -->
      <mat-form-field class="full-width">
        <mat-label>Beschreibung</mat-label>
        <textarea
          matInput
          rows="3"
          formControlName="text"
          placeholder="Beschreibung / Notiz"
        ></textarea>
      </mat-form-field>

      <!-- Betrag -->
      <mat-form-field class="full-width">
        <mat-label>Betrag</mat-label>
        <input
          matInput
          type="number"
          formControlName="betrag"
          placeholder="Betrag (positiv)"
        />
        <span matTextSuffix>CHF</span>

        @if (form.get('betrag')?.hasError('required') && form.get('betrag')?.touched) {
          <mat-error>Betrag ist erforderlich</mat-error>
        }
        @if (form.get('betrag')?.hasError('min') && form.get('betrag')?.touched) {
          <mat-error>Betrag muss grösser als 0 sein</mat-error>
        }
      </mat-form-field>
    </mat-card-content>

    <mat-card-actions align="end">
      <button mat-button type="button" (click)="cancel()">Abbrechen</button>
      <button mat-flat-button color="primary" type="submit">
        Speichern
      </button>
    </mat-card-actions>

  </mat-card>
</form>
